<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    
    <title>FLX Calc - Protocolo de Elite</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563EB">
    <meta name="description" content="Calculadora de Carga e Aquecimento para Powerlifting e Musculação">
    <link rel="apple-touch-icon" href="icon-192.png">

    <script src="https://cdn.tailwindcss.com"></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;900&display=swap"
      rel="stylesheet"
    />

    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      body {
        font-family: 'Outfit', sans-serif;
      }
      /* Remove setas do input number */
      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      input[type='number'] {
        -moz-appearance: textfield;
      }
    </style>
  </head>
  <body class="bg-white text-black">
    <div id="root"></div>

    <script type="text/babel">
      // --- ÍCONES (Embutidos para não depender de biblioteca externa) ---
      const Dumbbell = ({ className, size = 24 }) => (
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width={size}
          height={size}
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          strokeWidth='2'
          strokeLinecap='round'
          strokeLinejoin='round'
          className={className}
        >
          <path d='m6.5 6.5 11 11' />
          <path d='m21 21-1-1' />
          <path d='m3 3 1 1' />
          <path d='m18 22 4-4' />
          <path d='m2 6 4-4' />
          <path d='m3 10 7-7' />
          <path d='m14 21 7-7' />
        </svg>
      );
      const Check = ({ className, size = 24 }) => (
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width={size}
          height={size}
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          strokeWidth='2'
          strokeLinecap='round'
          strokeLinejoin='round'
          className={className}
        >
          <polyline points='20 6 9 17 4 12' />
        </svg>
      );
      const Hash = ({ className, size = 24 }) => (
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width={size}
          height={size}
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          strokeWidth='2'
          strokeLinecap='round'
          strokeLinejoin='round'
          className={className}
        >
          <line x1='4' x2='20' y1='9' y2='9' />
          <line x1='4' x2='20' y1='15' y2='15' />
          <line x1='10' x2='8' y1='3' y2='21' />
          <line x1='16' x2='14' y1='3' y2='21' />
        </svg>
      );
      const ArrowRight = ({ className, size = 24 }) => (
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width={size}
          height={size}
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          strokeWidth='2'
          strokeLinecap='round'
          strokeLinejoin='round'
          className={className}
        >
          <path d='M5 12h14' />
          <path d='m12 5 7 7-7 7' />
        </svg>
      );
      const AlertCircle = ({ className, size = 24 }) => (
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width={size}
          height={size}
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          strokeWidth='2'
          strokeLinecap='round'
          strokeLinejoin='round'
          className={className}
        >
          <circle cx='12' cy='12' r='10' />
          <line x1='12' x2='12' y1='8' y2='12' />
          <line x1='12' x2='12.01' y1='16' y2='16' />
        </svg>
      );
      const ChevronDown = ({ className, size = 24 }) => (
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width={size}
          height={size}
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          strokeWidth='2'
          strokeLinecap='round'
          strokeLinejoin='round'
          className={className}
        >
          <path d='m6 9 6 6 6-6' />
        </svg>
      );
      const Layers = ({ className, size = 24 }) => (
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width={size}
          height={size}
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          strokeWidth='2'
          strokeLinecap='round'
          strokeLinejoin='round'
          className={className}
        >
          <polygon points='12 2 2 7 12 12 22 7 12 2' />
          <polyline points='2 17 12 22 22 17' />
          <polyline points='2 12 12 17 22 12' />
        </svg>
      );
      const Zap = ({ className, size = 24 }) => (
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width={size}
          height={size}
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          strokeWidth='2'
          strokeLinecap='round'
          strokeLinejoin='round'
          className={className}
        >
          <polygon points='13 2 3 14 12 14 11 22 21 10 12 10 13 2' />
        </svg>
      );
      const Scale = ({ className, size = 24 }) => (
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width={size}
          height={size}
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          strokeWidth='2'
          strokeLinecap='round'
          strokeLinejoin='round'
          className={className}
        >
          <path d='m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z' />
          <path d='m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z' />
          <path d='M7 21h10' />
          <path d='M12 3v18' />
          <path d='M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2' />
        </svg>
      );

      // --- APLICATIVO ---
      const FLXCalc = () => {
        const [workLoad, setWorkLoad] = React.useState('');
        const [sets, setSets] = React.useState([]);
        const [completed, setCompleted] = React.useState([]);
        const [exercise, setExercise] = React.useState('agachamento');
        const [dayType, setDayType] = React.useState('pesado'); // 'pesado' | 'leve'
        const [backoffSets, setBackoffSets] = React.useState(null);

        const allExercises = [
          { id: 'agachamento', label: 'Agachamento' },
          { id: 'supino', label: 'Supino' },
          { id: 'terra', label: 'Levantamento Terra' },
          { id: 'desenvolvimento', label: 'Desenvolvimento' },
          { id: 'remada', label: 'Remada' },
        ];

        const lightDayExercises = [
          { id: 'supino', label: 'Supino' },
          { id: 'desenvolvimento', label: 'Desenvolvimento' },
        ];

        const currentExercises =
          dayType === 'leve' ? lightDayExercises : allExercises;

        React.useEffect(() => {
          const isValid = currentExercises.find((ex) => ex.id === exercise);
          if (!isValid) {
            setExercise(currentExercises[0].id);
          }
        }, [dayType]);

        const roundToTen = (val) => Math.round(val / 10) * 10;

        const calculateWarmup = (targetWeight) => {
          if (!targetWeight || targetWeight < 20) return [];

          const startWeight = targetWeight < 70 ? 20 : 30;
          let warmupSets = [];

          let rawLastWarmup = targetWeight - 20;
          let lastWarmup = roundToTen(rawLastWarmup);

          if (targetWeight - lastWarmup > 20) lastWarmup += 10;
          if (lastWarmup >= targetWeight)
            lastWarmup = roundToTen(targetWeight - 10);
          if (lastWarmup <= startWeight) lastWarmup = startWeight;

          const totalGap = lastWarmup - startWeight;

          let maxJump = 25;
          if (targetWeight > 140) maxJump = 30;
          if (targetWeight > 220) maxJump = 35;
          if (targetWeight > 280) maxJump = 40;

          let numberOfSteps = Math.ceil(totalGap / maxJump);
          if (numberOfSteps < 3) numberOfSteps = 3;

          const stepSize = totalGap / numberOfSteps;

          warmupSets.push({
            weight: startWeight,
            reps: 15,
            percent: Math.round((startWeight / targetWeight) * 100),
          });

          for (let i = 1; i <= numberOfSteps; i++) {
            let val = startWeight + stepSize * i;
            let finalWeight = roundToTen(val);

            if (i === numberOfSteps) finalWeight = lastWarmup;

            let reps = 1;
            const setNum = i + 1;
            if (setNum === 2) reps = 5;
            else if (setNum === 3) reps = 3;
            else if (setNum === 4) reps = 2;
            else reps = 1;

            warmupSets.push({
              weight: finalWeight,
              reps: reps,
              percent: Math.round((finalWeight / targetWeight) * 100),
            });
          }

          const uniqueSets = [];
          warmupSets.forEach((s, i) => {
            if (i === 0) uniqueSets.push(s);
            else {
              if (s.weight > uniqueSets[uniqueSets.length - 1].weight) {
                uniqueSets.push(s);
              }
            }
          });

          return uniqueSets;
        };

        React.useEffect(() => {
          if (workLoad && parseFloat(workLoad) > 0) {
            const calculated = calculateWarmup(parseFloat(workLoad));
            setSets(calculated);

            if (dayType === 'pesado' && exercise === 'terra') {
              const backoffWeight = roundToTen(parseFloat(workLoad) * 0.8);
              setBackoffSets({ weight: backoffWeight, sets: 2, reps: 5 });
            } else {
              setBackoffSets(null);
            }
          } else {
            setSets([]);
            setBackoffSets(null);
          }
        }, [workLoad, exercise, dayType]);

        const toggleSet = (index) => {
          if (completed.includes(index)) {
            setCompleted(completed.filter((i) => i !== index));
          } else {
            setCompleted([...completed, index]);
          }
        };

        // Cores baseadas no Azul FLX (Dodger Blue - aproximado ao #1E90FF ou similar da imagem)
        // Usando blue-600 do Tailwind que é bem próximo
        const themeColor = {
          text: 'text-blue-600',
          bg: 'bg-blue-600',
          bgLight: 'bg-blue-50',
          border: 'border-blue-600',
          borderLight: 'border-blue-100',
          shadow: 'shadow-blue-200',
          ring: 'ring-blue-50',
          selectionBg: 'selection:bg-blue-100',
          selectionText: 'selection:text-blue-900',
          subText: 'text-blue-400',
        };

        return (
          <div
            className={`min-h-screen bg-white text-black font-sans pb-20 ${themeColor.selectionBg} ${themeColor.selectionText}`}
          >
            <div className='max-w-xl mx-auto px-6 py-8'>
              {/* Header */}
              <header className='mb-8 flex items-center justify-between'>
                <div>
                  <h1
                    className={`text-4xl font-black tracking-tighter mb-0 ${themeColor.text}`}
                  >
                    FLX Calc
                  </h1>
                  <p className='text-black text-sm font-bold tracking-widest'>
                    Protocolo de Elite
                  </p>
                </div>
                <div className={`${themeColor.bg} text-white p-2 rounded-lg`}>
                  <Dumbbell className='w-6 h-6' strokeWidth={2} />
                </div>
              </header>

              {/* Seletor de Dia */}
              <div className='mb-8 grid grid-cols-2 bg-gray-100 p-1.5 rounded-xl gap-2'>
                <button
                  onClick={() => setDayType('pesado')}
                  className={`
                                            flex items-center justify-center gap-2 py-3 rounded-lg font-bold text-sm uppercase tracking-wide transition-all
                                            ${
                                              dayType === 'pesado'
                                                ? 'bg-black text-white shadow-md'
                                                : 'text-gray-400 hover:text-gray-600'
                                            }
                                        `}
                >
                  <Scale size={18} />
                  Dia Pesado
                </button>
                <button
                  onClick={() => setDayType('leve')}
                  className={`
                                            flex items-center justify-center gap-2 py-3 rounded-lg font-bold text-sm uppercase tracking-wide transition-all
                                            ${
                                              dayType === 'leve'
                                                ? `${themeColor.bg} text-white shadow-md`
                                                : 'text-gray-400 hover:text-gray-600'
                                            }
                                        `}
                >
                  <Zap size={18} />
                  Dia Leve
                </button>
              </div>

              {/* Seletor de Exercício */}
              <div className='mb-8'>
                <label className='block text-xs font-bold uppercase tracking-widest text-gray-400 mb-2'>
                  Exercício
                </label>
                <div className='grid grid-cols-1 relative'>
                  <select
                    value={exercise}
                    onChange={(e) => setExercise(e.target.value)}
                    className={`appearance-none w-full bg-gray-50 border-2 border-gray-200 text-xl font-bold p-4 rounded-xl focus:outline-none focus:${themeColor.border} transition-colors cursor-pointer text-black`}
                  >
                    {currentExercises.map((ex) => (
                      <option key={ex.id} value={ex.id}>
                        {ex.label}
                      </option>
                    ))}
                  </select>
                  <ChevronDown className='absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none' />
                </div>
              </div>

              {/* Input Carga */}
              <div className='mb-10'>
                <label className='block text-xs font-bold uppercase tracking-widest text-gray-400 mb-3'>
                  Carga de Trabalho (Work Set)
                </label>
                <div className='relative group'>
                  <input
                    type='number'
                    value={workLoad}
                    onChange={(e) => setWorkLoad(e.target.value)}
                    placeholder='0'
                    className='w-full text-7xl font-black border-b-4 border-gray-200 py-4 focus:outline-none focus:border-black transition-colors bg-transparent placeholder-gray-200'
                    step='any'
                  />
                  <span className='absolute right-0 top-1/2 -translate-y-1/2 text-xl font-bold text-gray-400 group-focus-within:text-black transition-colors'>
                    KG
                  </span>
                </div>

                {workLoad &&
                  parseFloat(workLoad) < 70 &&
                  parseFloat(workLoad) > 0 && (
                    <div
                      className={`flex items-center gap-2 mt-2 ${themeColor.text} text-xs font-medium ${themeColor.bgLight} p-2 rounded-lg`}
                    >
                      <AlertCircle size={14} />
                      <span>
                        Carga menor que 70kg: Início ajustado para 20kg.
                      </span>
                    </div>
                  )}
              </div>

              {/* Lista Aquecimento */}
              <div className='space-y-3 relative'>
                {sets.length > 0 && (
                  <div className='flex items-center gap-2 mb-4'>
                    <span className='bg-black text-white text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider'>
                      Aquecimento
                    </span>
                    <div className='h-px bg-gray-200 flex-grow'></div>
                  </div>
                )}

                {sets.length > 0 && (
                  <div className='absolute left-[26px] top-10 bottom-10 w-0.5 bg-gray-100 -z-10'></div>
                )}

                {sets.map((set, index) => {
                  const isDone = completed.includes(index);
                  const isNext =
                    !isDone && (index === 0 || completed.includes(index - 1));
                  const prevWeight = index === 0 ? 0 : sets[index - 1].weight;
                  const jump = index === 0 ? 0 : set.weight - prevWeight;

                  return (
                    <div
                      key={index}
                      onClick={() => toggleSet(index)}
                      className={`
                                                    relative flex items-center gap-6 p-4 rounded-xl cursor-pointer transition-all duration-300 group select-none
                                                    ${
                                                      isDone
                                                        ? 'opacity-30 grayscale blur-[0.5px]'
                                                        : 'opacity-100'
                                                    }
                                                    ${
                                                      isNext
                                                        ? `bg-black text-white shadow-xl scale-[1.02] translate-x-1 ring-4 ${themeColor.ring}`
                                                        : 'bg-white border border-gray-100 hover:border-gray-300'
                                                    }
                                                `}
                    >
                      <div
                        className={`
                                                        flex-shrink-0 w-14 h-14 rounded-full border-2 flex items-center justify-center transition-all
                                                        ${
                                                          isDone
                                                            ? 'bg-black border-black'
                                                            : isNext
                                                            ? 'bg-white border-transparent text-black'
                                                            : 'bg-gray-100 border-transparent text-gray-300 group-hover:border-gray-400'
                                                        }
                                                    `}
                      >
                        {isDone ? (
                          <Check size={24} className='text-white' />
                        ) : (
                          <span className='text-lg font-bold'>{index + 1}</span>
                        )}
                      </div>

                      <div className='flex-grow flex flex-col justify-center'>
                        <div className='flex items-baseline gap-2'>
                          <span className='text-4xl font-black tracking-tight leading-none'>
                            {set.weight}
                          </span>
                          <span
                            className={`text-xs font-bold uppercase tracking-wider ${
                              isNext ? 'text-gray-400' : 'text-gray-400'
                            }`}
                          >
                            kg
                          </span>
                        </div>

                        <div className='flex items-center gap-3 mt-1'>
                          {index > 0 && (
                            <span
                              className={`text-[10px] font-bold flex items-center gap-1 px-1.5 py-0.5 rounded ${
                                isNext
                                  ? 'bg-white/20 text-gray-200'
                                  : 'bg-gray-100 text-gray-500'
                              }`}
                            >
                              <ArrowRight size={10} /> +{jump}kg
                            </span>
                          )}
                          <span
                            className={`text-[10px] font-bold ${
                              isNext ? 'text-gray-500' : 'text-gray-400'
                            }`}
                          >
                            {set.percent}%
                          </span>
                        </div>
                      </div>

                      <div className='text-right min-w-[60px]'>
                        <div
                          className={`text-4xl font-black leading-none ${
                            isNext ? 'text-white' : 'text-black'
                          }`}
                        >
                          {set.reps}
                        </div>
                        <div
                          className={`text-[9px] uppercase font-bold tracking-widest mt-1 ${
                            isNext ? 'text-gray-400' : 'text-gray-400'
                          }`}
                        >
                          Reps
                        </div>
                      </div>
                    </div>
                  );
                })}

                {/* Work Set Card */}
                {workLoad && sets.length > 0 && (
                  <div className='pt-8'>
                    <div className='flex items-center gap-2 mb-4'>
                      <span
                        className={`${themeColor.bg} text-white text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider`}
                      >
                        Work Set
                      </span>
                      <div className='h-px bg-blue-100 flex-grow'></div>
                    </div>

                    <div
                      className={`flex items-center gap-6 p-6 rounded-2xl border-2 ${themeColor.border} ${themeColor.bgLight} shadow-sm relative overflow-hidden`}
                    >
                      <div
                        className={`absolute top-0 right-0 p-4 opacity-10 ${themeColor.text}`}
                      >
                        <Hash size={120} />
                      </div>

                      <div
                        className={`w-14 h-14 ${themeColor.bg} rounded-full flex items-center justify-center text-white shrink-0 z-10 shadow-lg ${themeColor.shadow}`}
                      >
                        <Dumbbell size={24} />
                      </div>
                      <div className='z-10'>
                        <div
                          className={`text-xs font-bold uppercase tracking-widest ${themeColor.subText} mb-1`}
                        >
                          {dayType === 'leve'
                            ? '3 Séries de Trabalho'
                            : exercise === 'terra'
                            ? '1 Série Pesada'
                            : '5 Séries de Trabalho'}
                        </div>
                        <div className='flex items-baseline gap-2'>
                          <span className='text-5xl font-black text-black tracking-tighter'>
                            {workLoad}
                          </span>
                          <span className='text-xl text-gray-400 font-bold'>
                            KG
                          </span>
                        </div>
                        <div
                          className={`mt-2 inline-flex bg-white px-3 py-1 rounded-full text-xs font-bold ${themeColor.text} shadow-sm border ${themeColor.borderLight}`}
                        >
                          {dayType === 'leve'
                            ? '3 x 8 Reps'
                            : exercise === 'terra'
                            ? '1 x 5 Reps'
                            : '5 x 5 Reps'}
                        </div>
                      </div>
                    </div>

                    {/* Backoff */}
                    {backoffSets && (
                      <div className='mt-4'>
                        <div className='flex items-center gap-4 p-5 rounded-xl border-l-4 border-gray-300 bg-gray-50'>
                          <div className='p-2 bg-white rounded-lg shadow-sm'>
                            <Layers size={20} className='text-gray-400' />
                          </div>
                          <div>
                            <div className='text-[10px] font-bold uppercase tracking-widest text-gray-400 mb-0.5'>
                              Backoff Sets (80%)
                            </div>
                            <div className='flex items-baseline gap-2'>
                              <span className='text-2xl font-black text-gray-700'>
                                {backoffSets.weight}kg
                              </span>
                              <span className='text-sm font-medium text-gray-400'>
                                x 5 reps
                              </span>
                            </div>
                            <div className='text-xs font-bold text-gray-500 mt-1'>
                              Realizar {backoffSets.sets} séries
                            </div>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<FLXCalc />);
    </script>
    
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('SW registrado com sucesso:', reg.scope))
                    .catch(err => console.error('Erro ao registrar SW:', err));
            });
        }
    </script>
  </body>
</html>